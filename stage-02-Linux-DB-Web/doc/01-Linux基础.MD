## Linux 基础

[<< 返回目录](../README.MD)

### 终端命令格式说明
```shell script
command [-options] [parameter]
```

- **command：** 命令名, 比如: ls、pwd
- **[-options]：** 选项，可以有零个、一个或者多个选项，多个选项可以合并，比如使用的 -r 就是选项。
- **[parameter]：** 参数，可以有零个、一个 或者 多个参数， 比如: touch 文件名、mkdir 目录名、cd 目标目录(路径)，这些文件名和目录名都是参数。
- **[]：** 代表可选

### Linux 基础命令
#### 1. 查看
命令|说明
---|---
ls|查看当前目录信息
tree|以树状方式显示目录信息
pwd	|查看当前目录路径
clear|清除终端内容

##### 1.1 ls
命令选项|	说明
---|---
-l	|以列表方式显示
-h	|件大小单位显示，默认是字节
-a	|显示隐藏文件和隐藏目录

#### 2. 切换目录
命令	|说明
---|---
cd 目录	|切换到指定目录
cd ~	|切换到当前用户的主目录
cd ..	|切换到上一级目录
cd .	|切换到当前目录
cd -	|切换到上一次目录

#### 3. 绝对路径\相对路径
> - 从根目录算起的路径叫做绝对路径
> - 从当前目录算起的路径叫做相对路径

#### 4. 文件、目录操作
命令	|说明
---|---
touch 文件名	|创建指定文件
mkdir 目录名	|创建目录(文件夹)
rm 文件名或者目录名	|删除指定文件或者目录，删除目录需要加 `-r`
rmdir 目录名	|删除空目录
cp	|拷贝文件、拷贝目录
mv	|移动文件、移动目录、重命名
##### 4.1 mkdir
命令选项	|说明
---|---
-p	创建所依赖的文件夹

##### 4.2 rm
命令选项|	说明
---|---
-i	|交互式提示
-r	|递归删除目录及其内容
-f	|强制删除，忽略不存在的文件，无需提示
-d	|删除空目录

##### 4.3 cp

命令选项	|说明
---|---
-i	|交互式提示
-r	|递归拷贝目录及其内容
-v	|显示拷贝后的路径描述
-a	|保留文件的原有权限

##### 4.4 mv
命令选项	|说明
---|---
-i	|交互式提示
-v	|显示移动后的路径描述

### Linux 高级命令
#### 1. 重定向
> 重定向也称为输出重定向，把在终端执行命令的结果保存到目标文件。

命令	|说明
---|---
\>	|如果文件存在会覆盖原有文件内容，相当于文件操作中的‘w’模式
\>>	|如果文件存在会追加写入文件末尾，相当于文件操作中的‘a’ 模式

#### 2. 查看文件内容
命令|说明
---|---
cat	|查看小型文件
more|	分屏查看大型文件

##### 2.1 cat
cat命令结合重定向可以完成多个文件的合并

##### 2.2 more
> 当查看内容信息过长无法在一屏上显示时，可以使用 more 命令在终端分配显示文件内容。
###### 查看时的键盘操作
操作键	|说明
----|----
空格	|显示下一屏信息
回车	|显示下一行信息
b	|显示上一屏信息
f	|显示下一屏信息
q	|退出

##### 管道(|)命令的使用
> - 一个命令的输出可以通过管道做为另一个命令的输入，可以理解成是一个容器，存放在终端显示的内容。
> - 管道(|)一般结合 more 命令使用，主要是分配查看终端显示内容。

#### 3. 链接
命令|	说明
---|---
ln -s	|创建软链接
ln	|创建硬链接

##### 3.1 **软链接**
> 类似于Windows下的快捷方式，当一个源文件的目录层级比较深，我们想要方便使用它可以给源文件创建一个软链接。

- 如果软链接和源文件不在同一个目录，源文件要使用绝对路径，不能使用相对路径。
- 删除源文件则软链接失效
- 可以给目录创建软链接

##### 3.2 **硬链接**
> 类似于源文件的一个别名，也就是说这两个名字指向的是同一个文件数据。

- 创建硬链接使用相对路径和绝对路径都可以
- 删除源文件，硬链接还可以访问到数据。
- 创建硬链接，硬链接数会加1，删除源文件或者硬链接，硬链接数会减1。
- 创建软链接，硬链接数不会加1
- 不能给目录创建硬链接

`* 硬链接数就是文件数据被文件名使用的次数, 好比引用计数`

#### 4. grep文件内查找
```shell script
grep "查找内容" 文件 [选项]
```
##### 可用选项
命令选项	|说明
---|---
-i	|忽略大小写
-n	|显示匹配行号
-v	|显示不包含匹配文本的所有行

##### 可结合正则表达式
正则表达式	|说明
---|---
^	|以指定字符串开头
$	|以指定字符串结尾
.	|匹配一个非换行符的字符

#### 5. find 文件查找(包含文件夹)
```shell script
find 指定查找目录 -name "文件名"
```
- **文件名：** 可结合通配符进行使用

通配符	|说明
---|---
*	|代表0个或多个任意字符
?	|代表任意一个字符

#### 6. 压缩和解压缩
Linux默认支持的压缩格式:
> - .gz
> - .bz2 
> - .zip

- gz和.bz2的压缩包需要使用tar命令来压缩和解压缩
- .zip的压缩包需要使用zip命令来压缩，使用unzip命令来解压缩
##### 6.1 tar命令
###### 命令选项
选项	|说明
---|---
-c	|创建打包文件
-v	|显示打包或者解包的详细信息
-f	|指定文件名称, 必须放到所有选项后面
-z	|压缩或解压缩(.gz)
-j	|压缩或解压缩(.bz2)
-x	|解包
-C	|解压缩到指定目录
##### 6.2 zip\unzip命令
```shell script
zip 压缩后名称 需要压缩的文件

unzip 压缩文件 [-d 解压缩到指定目录]
```

> * 压缩文件尽量使用.gz格式，因为占用空间较少
> * 使用zip命令压缩的文件占用空间比较多, 当时比较通用，操作更加简单。

##### 常见用法
- 压缩程.gz文件
```shell script
# 将当前文件夹下 *.txt文件压缩到 test.tar.gz文件中
tar -zcvf test.tar.gz *.txt 
```
- 压缩成.bz2文件
```shell script
# 将当前文件夹下 *.txt文件压缩到 test.tar.bz2文件中
tar - jcvf test.tar.bz2 *.txt
```

- 解压.gz文件
```shell script
# 解压到当前目录
tar -zxcf test.tar.gz

# 解压到指定目录
tar -zxvf test.tar.gz -C 目录
```

- 解压.bz2文件
```shell script
# 解压到当前目录
tar -jxvf test.tar.bz2 

# 解压到指定目录
tar -jxvf test.tar.bz2 -C 目录
```

#### 7. chmod 文件权限
- 角色说明:

角色	|说明
---|---
u	|user, 表示该文件的所有者
g	|group, 表示用户组
o	|other, 表示其他用户
a	|all, 表示所有用户

- 权限设置说明:

操作符	|说明
---|---
+	|增加权限
-	|撤销权限
=	|设置权限

- 权限说明:

权限|	说明|权限数字
---|---|---
r	|可读|4
w	|可写|2
x	|可执行|1
-	|无任何权限|0

###### 7.1 命令格式
- 字母法
```shell script
# chomd 角色+权限设置+权限组合 设置对象
chomd u+rw test.txt
chomd o-x test.txt
```
- 数字法
```shell script
# chomd [user权限数字][group权限数字][other权限数字] 设置对象
chomd 666 设置对象 # 可读可写
chomd 764 设置对象 # user 可读可写可执行、group可读可写、other只读

```

#### 8. 获取管理员权限
##### 8.1 sudo命令的使用
命令	|说明
---|---
sudo -s	|切换到root用户，获取管理员权限
sudo	|某个命令的执行需要获取管理员权限可以在执行命令前面加上sudo

##### 8.2 whoami
> 查看当前拥有者

##### 8.3 exit
> 退出登录用户

- 如果是切换后的登陆用户，退出则返回上一个登陆账号。
- 如果是终端界面，退出当前终端。

##### 8.4 who
> 查询所有登录用户

##### 8.5 password
```shell script
password [用户名]
```
> 修改用户密码，不指定用户默认修改当前登录用户密码

##### 8.6 which
> 查找命令的位置
```shell script
$ which python3
/usr/local/bin/python3
```

##### 8.7 关机和重启

###### shutdown
```shell script
shutdown [-t seconds] [-rkhncfF] time [message]
```
```text
-t seconds : 设定在几秒钟之后进行关机程序。
-k : 并不会真的关机，只是将警告讯息传送给所有使用者。
-r : 关机后重新开机。
-h : 关机后停机。
-n : 不采用正常程序来关机，用强迫的方式杀掉所有执行中的程序后自行关机。
-c : 取消目前已经进行中的关机动作。
-f : 关机时，不做 fcsk 动作(检查 Linux 档系统)。
-F : 关机时，强迫进行 fsck 动作。
time : 设定关机的时间。
message : 传送给所有使用者的警告讯息。
```
示例：
```shell script
# 立即关机
$ shutdown -h now
# 10分钟后关机
$ shutdown -h 10
# 重新启动计算机
$ shutdown -r now
```

###### reboot
>  若系统的 runlevel 为 0 或 6 ，则重新开机，否则以 shutdown 指令（加上 -r 参数）来取代

```shell script
reboot [-n] [-w] [-d] [-f] [-i]
```
```text
-n : 在重开机前不做将记忆体资料写回硬盘的动作
-w : 并不会真的重开机，只是把记录写到 /var/log/wtmp 档案里
-d : 不把记录写到 /var/log/wtmp 档案里（-n 这个参数包含了 -d）
-f : 强迫重开机，不呼叫 shutdown 这个指令
-i : 在重开机之前先把所有网络相关的装置先停止
```

#### 9. 用户相关操作
##### 9.1 useradd
> 创建用户

选项	|说明
---|---
-m	|自动创建用户主目录,主目录的名字就是用户名
-g	|指定用户所属的用户组，默认不指定会自动创建一个同名的用户组

###### 示例
```shell script
sudo useradd -m yshye
```
###### 说明
- `useradd` 命令的使用需要使用管理员权限，前面需要加上 `sudo`
- 创建用户如果不指定用户组，默认会自动创建一个同名的用户组
- 查看用户是否创建成功，可以查看`/etc/passwd`这个文件
- 查看用户组是否创建成功，可以查看`/etc/group`这个文件

> `passwd`文件中的每项信息说明,以`root:x:0:0:root:/root:/bin/bash`为例:

```text
 第一个：用户名
 第二个：密码占位符
 第三个：uid, 用户id
 第四个：gid, 用户所在组id
 第五个：用户描述, 可选，
 第六个：用户的主目录所在位置
 第七个：用户所用 shell 的类型，一般由bash或者sh，默认不设置是sh类型
```

>`group`文件中的每项信息说明, 以`yshye:x:1001:`为例:
```text
 第一个：用户组名
 第二个：用户组密码占位符，一般Linux系统的用户组都没有密码的
 第三个：组id
```

##### 9.2 id
```shell script
id 用户名
```
> `uid=1001(laowang) gid=1001(laowang) 组=1001(laowang)` 每项信息说明:
```text
第一个: uid 表示用户id
第二个: gid 表示用户组id
第三个: 组 表示用户所在的用户组
```

##### 9.3 sudo passwd
> 设置密码

```shell script
sudo passwd 用户名
```

##### 9.4 切换用户
```shell script
su - 用户名
```

##### 9.5 usermod
> 修改用户信息
```shell script
sudo usermod [-g/-G] 
```
###### 配置参数
命令	|说明
---|---
-G	|设置一个附加组
-g	|修改用户组

##### 9.6 gpasswd
> 添加或删除附加组
###### 配置参数
选项	|说明
---|---
-a 用户名	|给用户添加附加组
-d 用户名	|给用户删除附加组

##### 9.7 userdel
> 删除用户
###### 配置参数
选项	|说明
---|---
-r 用户名	|删除用户主目录，必须要设置，否则用户主目录不会删除

> 删除用户，默认同名的用户组也会被删除

#### 10. 用户组相关操作
##### 10.1 groupadd
> 添加用户组
```shell script
sudo groupadd 组名
```

##### 10.2 创建用户并添加到用户组
```shell script
sudo useradd -m -g yshye root
```

##### 10.3 修改用户组
```shell script
sudo usermod -g 用户  新组名
```

##### 10.4 删除用户组
```shell script
sudo groupdel 组名 # 如果用户组下面有用户，需要先删除下面的用户
```

#### 11. vim
##### 11.1 介绍
> vim 是一款功能强大的文本编辑器，也是早年 Vi 编辑器的加强版，它的最大特色就是使用命令进行编辑，完全脱离了鼠标的操作。

##### 11.2 vim 的工作模式
- 命令模式
- 编辑模式
- 末行模式
    ```text
    :w 保存
    :wq 保存退出
    :x 保存退出
    :q! 强制退出
    ```

##### 11.3 vim 的常用命令

命令	|说明
---|---
yy	| 复制光标所在行
p	|粘贴
dd	|删除/剪切当前行
V	|按行选中
u	|撤销
ctr+r	|反撤销
\>>	|往右缩进
<<	|往左缩进
:/搜索的内容	|搜索指定内容
:%s/要替换的内容/替换后的内容/g	|全局替换
:开始行数,结束行数s/要替换的内容/替换后的内容	|局部替换
.	|重复上一次命令操作
G	|回到最后一行
gg	|回到第一行
数字+G	|回到指定行
shift+6	|回到当前行的行首
shift+4	|回到当前行的行末
ctr+f	|下一屏
ctr+b	|上一屏
